{% extends "base.html" %}

{% block head %}
    {% if question.question_open %}
        <script>
            setTimeout(function(){ window.location = window.location; }, 10000);
        </script>
    {% endif %}
{% endblock %}

{% block content %}
    {% if request.user.is_staff %}
        <head>
            <style>
.container {
  max-width: 100%;
  width: 100%;
  font-size: 300%;
  padding-left: 1em;
  padding-right: 1em;
}
.breadcrumb {
    font-size: 33%;
}
            </style>
        </head>
    {% endif %}
    <ol class="breadcrumb">
      <li><a href="{% url 'polls:index' %}">Overzicht</a></li>
        {% if question.question_open and not request.user.is_staff %}
            <li><a href="{% url 'polls:detail' question.id %}">Stemmen</a></li>
        {% else %}
            <li>Stemmen</li>
        {% endif %}
      <li class="active">Resultaten</li>
    </ol>            
    
    {% if request.user.is_staff %}
        <p style="float:right;"><a href="{% url 'polls:prev' question.id %}" class="btn btn-default">Vorige</a>
        <a href="{% url 'polls:next' question.id %}" class="btn btn-default">Volgende</a></p>
    {% endif %}

    <p>
        <strong>{{ question.question_text }}</strong>
        {% if request.user.is_staff %}
            - Categorie {{ question.question_category }},

            Advies:
            {% if question.question_advice == 'negative' %}
                <span style="color:darkred;">Niet overnemen</span>
            {% endif %}
            {% if question.question_advice == 'neutral' %}
                Neutraal
            {% endif %}
            {% if question.question_advice == 'positive' %}
                <span style="color:green;">Overnemen</span>
            {% endif %}        
            {% if question.question_advice == 'na' %}
                NVT - bestuursamendement
            {% endif %}        
        {% endif %}        
    </p>
    {% if request.user.is_staff %}
        <p style="background: white;padding:0.4em;">
            {{ question.question_change }}
        </p>    
        <p>
            <span style="font-size:70%;"><em>Indieners:</em>
            {{ question.question_people }}</span>
        </p>    
    {% endif %}
    {% if question.question_open %}
        {% if not request.user.is_staff %}
            {% if user_voted %}
                <div class="alert alert-success" role="alert">
                    <strong>U heeft gestemd.</strong>
                    <a href="{% url 'polls:detail' question.id %}" class="btn btn-warning">Stem aanpassen</a>
                </div>
            {% else %}
                <div class="alert alert-danger" role="alert"><strong>U heeft niet gestemd.</strong>
                    <a href="{% url 'polls:detail' question.id %}" class="btn btn-danger">Stemmen</a>
                </div>
            {% endif %}
        {% endif %}        

        <p>
            De stemming staat op dit moment open.
        </p>
        
        <p>
            <table class="table">
                <tr><th>Keuze</th><th>Stemmen</th></tr>
                {% for choice in question.choice_set.all %}
                    <tr><td>{{ choice.choice_text }}</td><td><em>...</em></td></tr>
                {% endfor %}
            </table>
        </p>        
    {% else %}
        {% if not request.user.is_staff %}
            {% if user_voted %}
                <div class="alert alert-success" role="alert">
                    <strong>U heeft gestemd.</strong>
                </div>
            {% else %}
                <div class="alert alert-danger" role="alert"><strong>U heeft niet gestemd.</strong>
                </div>
            {% endif %}
        {% endif %}      
        <table class="table">
            <tr><th>Keuze</th><th>Stemmen</th></tr>
            {% for choice in question.choice_set.all %}
                <tr><td>{{ choice.choice_text }}</td><td>{{ choice.answer_set.count }}</td></tr>
            {% endfor %}
        </table>
    {% endif %}
    <p>Aantal uitgebrachte stemmen: {{ question.answer_set.count }}</p>
    <p><a href="{% url 'polls:index' %}" class="btn btn-primary btn-block">Terug naar overzicht</a></p>
    {% if request.user.is_staff and question.question_open%}
        <p><a href="{% url 'polls:close' question.id %}" class="btn btn-default btn-block">Sluit de stemming</a></p>
    {% endif %}
    {% if request.user.is_staff and not question.question_open%}
        <p><a href="{% url 'polls:open' question.id %}" class="btn btn-default btn-block">Open de stemming</a></p>
    {% endif %}
    {% if request.user.is_staff and not question.question_open%}
        <p><a href="{% url 'polls:hide' question.id %}" class="btn btn-default btn-block">Verberg de stemming</a></p>
    {% endif %}
    {% if request.user.is_staff and not question.question_open%}
        <p><a href="{% url 'polls:reset' question.id %}" class="btn btn-default btn-block">Reset de stemming</a></p>
    {% endif %}
{% endblock %}
